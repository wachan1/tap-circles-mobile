<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>Tap Circles Game</title>
  <style>
    body {
      margin: 0;
      background: #111;
      color: white;
      font-family: Arial, sans-serif;
      overflow: hidden;
      touch-action: manipulation;
      -webkit-user-select: none;
      user-select: none;
    }
    #top-bar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 10px 20px;
      font-size: 18px;
      font-weight: bold;
      background: rgba(0, 0, 0, 0.3);
      z-index: 10;
    }
    #game-area {
      position: absolute;
      top: 40px;
      bottom: 60px;
      left: 0;
      right: 0;
      overflow: hidden;
    }
    #bottom-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 10px 20px;
      background: rgba(0, 0, 0, 0.3);
      z-index: 10;
    }
    button {
      background: #444;
      border: none;
      padding: 10px 20px;
      color: white;
      font-size: 16px;
      border-radius: 6px;
    }
    button:active {
      background: #666;
    }
    .circle {
      position: absolute;
      border-radius: 50%;
      background: white;
      opacity: 0.9;
      transform: translate(-50%, -50%);
    }
    #pause-overlay {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      z-index: 20;
      display: none;
    }
    #pause-overlay button {
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <div id="top-bar">
    <div id="score">Score: 1000</div>
    <div id="high-score">High: 0</div>
  </div>

  <div id="game-area"></div>

  <div id="bottom-bar">
    <button id="restart">Restart</button>
    <button id="pause">Pause</button>
  </div>

  <div id="pause-overlay">
    <div>Game Paused</div>
    <button id="resume">Resume</button>
  </div>

  <script>
    const gameArea = document.getElementById("game-area");
    const scoreDisplay = document.getElementById("score");
    const highScoreDisplay = document.getElementById("high-score");
    const pauseBtn = document.getElementById("pause");
    const restartBtn = document.getElementById("restart");
    const pauseOverlay = document.getElementById("pause-overlay");
    const resumeBtn = document.getElementById("resume");

    let score = 1000;
    let highScore = parseInt(localStorage.getItem("highScore")) || 0;
    let circles = [];
    let gameRunning = true;
    let paused = false;
    let elapsedTime = 0; // seconds
    let lastSpawn = 0;

    highScoreDisplay.textContent = "High: " + highScore;

    class Circle {
      constructor(x, y) {
        this.x = x;
        this.y = y;
        this.size = 20;
        this.maxSize = 200;
        this.growthRate = 0.5;
        this.element = document.createElement("div");
        this.element.className = "circle";
        this.element.style.left = `${x}px`;
        this.element.style.top = `${y}px`;
        this.element.style.width = this.size + "px";
        this.element.style.height = this.size + "px";

        this.element.addEventListener("click", () => this.destroy());

        gameArea.appendChild(this.element);
      }
      update(delta) {
        this.size += this.growthRate * delta;
        if (this.size > this.maxSize) {
          score -= 50;
          this.remove();
        } else {
          this.updateColor();
          this.element.style.width = this.size + "px";
          this.element.style.height = this.size + "px";
        }
      }
      updateColor() {
        let p = this.size / this.maxSize;
        if (p < 0.33) this.element.style.background = "white";
        else if (p < 0.66) this.element.style.background = "blue";
        else if (p < 0.9) this.element.style.background = "red";
        else this.element.style.background = "black";
      }
      destroy() {
        let p = 1 - this.size / this.maxSize;
        let gained = Math.max(10, Math.floor(p * 200));
        score += gained;
        this.remove();
      }
      remove() {
        gameArea.removeChild(this.element);
        circles = circles.filter(c => c !== this);
      }
    }

    function spawnCircle() {
      let x = Math.random() * gameArea.clientWidth;
      let y = Math.random() * gameArea.clientHeight;
      circles.push(new Circle(x, y));
    }

    let lastTime = performance.now();

    function gameLoop(now) {
      if (!gameRunning) return;
      if (paused) {
        lastTime = now;
        requestAnimationFrame(gameLoop);
        return;
      }

      let delta = (now - lastTime) / 16.67;
      lastTime = now;

      // Update elapsed time
      elapsedTime += delta / 60;

      // Progressive difficulty
      let spawnInterval = Math.max(500, 2000 - elapsedTime * 50); // faster spawns
      let maxCircles = Math.min(6, 1 + Math.floor(elapsedTime / 10));
      let growthBoost = 0.01 * elapsedTime; // increase growth rate over time

      // Spawn circles
      if (now - lastSpawn > spawnInterval && circles.length < maxCircles) {
        spawnCircle();
        lastSpawn = now;
      }

      // Update circles
      circles.forEach(c => {
        c.growthRate = 0.5 + growthBoost;
        c.update(delta);
      });

      // Update score
      score -= delta * 1.5; // lose points over time
      if (score <= 0) {
        gameOver();
      }

      // Update UI
      scoreDisplay.textContent = "Score: " + Math.max(0, Math.floor(score));
      if (score > highScore) {
        highScore = Math.floor(score);
        localStorage.setItem("highScore", highScore);
      }
      highScoreDisplay.textContent = "High: " + highScore;

      requestAnimationFrame(gameLoop);
    }

    function gameOver() {
      gameRunning = false;
      alert("Game Over! Final score: " + Math.floor(score));
    }

    pauseBtn.addEventListener("click", () => {
      paused = true;
      pauseOverlay.style.display = "flex";
    });

    resumeBtn.addEventListener("click", () => {
      paused = false;
      pauseOverlay.style.display = "none";
    });

    restartBtn.addEventListener("click", () => {
      score = 1000;
      elapsedTime = 0;
      lastSpawn = 0;
      circles.forEach(c => c.remove());
      circles = [];
      gameRunning = true;
      paused = false;
      pauseOverlay.style.display = "none";
      lastTime = performance.now();
      requestAnimationFrame(gameLoop);
    });

    requestAnimationFrame(gameLoop);
  </script>
</body>
</html>
